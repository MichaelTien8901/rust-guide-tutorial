<!-- Custom Mermaid configuration with light background for visibility -->
<script type="module">
  // Wait for Mermaid to be available
  const configureMermaid = () => {
    if (typeof mermaid !== 'undefined') {
      mermaid.initialize({
        startOnLoad: true,
        theme: 'base',
        securityLevel: 'loose',
        themeVariables: {
          // Use LIGHT background for visibility on any page theme
          background: '#ffffff',
          mainBkg: '#f8f9fa',

          // Primary colors - blue tones
          primaryColor: '#4a90d9',
          primaryTextColor: '#1a1a1a',
          primaryBorderColor: '#2171b5',

          // Secondary colors - green tones
          secondaryColor: '#6cc644',
          secondaryTextColor: '#1a1a1a',
          secondaryBorderColor: '#4a9c2d',

          // Tertiary colors - purple tones
          tertiaryColor: '#a855f7',
          tertiaryTextColor: '#1a1a1a',
          tertiaryBorderColor: '#7c3aed',

          // Lines and arrows - dark for contrast on light background
          lineColor: '#333333',

          // Node styling
          nodeBkg: '#e8f4fd',
          nodeTextColor: '#1a1a1a',
          nodeBorder: '#2171b5',

          // Text colors - dark for light background
          textColor: '#1a1a1a',

          // Flowchart clusters
          clusterBkg: '#f0f4f8',
          clusterBorder: '#5a6c7d',

          // Notes
          noteBkgColor: '#fff8dc',
          noteTextColor: '#1a1a1a',
          noteBorderColor: '#d4a574',

          // Sequence diagram
          actorBkg: '#e8f4fd',
          actorBorder: '#2171b5',
          actorTextColor: '#1a1a1a',
          actorLineColor: '#333333',
          signalColor: '#333333',
          signalTextColor: '#1a1a1a',

          // Critical and done styles (for Gantt)
          critBkgColor: '#fee2e2',
          critBorderColor: '#dc2626',
          doneBkgColor: '#d1fae5',
          doneBorderColor: '#059669',

          // Edge labels
          edgeLabelBackground: '#ffffff',

          // Gantt chart
          sectionBkgColor: '#e8f4fd',
          altSectionBkgColor: '#f0f4f8',
          gridColor: '#cbd5e1',
          todayLineColor: '#dc2626',

          // Mindmap
          mindmapNodeBkg: '#e8f4fd'
        },
        flowchart: {
          useMaxWidth: true,
          htmlLabels: true,
          curve: 'basis',
          diagramPadding: 8
        },
        sequence: {
          diagramMarginX: 50,
          diagramMarginY: 10,
          actorMargin: 50,
          width: 150,
          height: 65,
          boxMargin: 10,
          boxTextMargin: 5,
          noteMargin: 10,
          messageMargin: 35
        },
        gantt: {
          titleTopMargin: 25,
          barHeight: 20,
          barGap: 4,
          topPadding: 50
        }
      });
    }
  };

  // Try to configure immediately and also after DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', configureMermaid);
  } else {
    // Small delay to ensure Mermaid script is loaded
    setTimeout(configureMermaid, 100);
  }
</script>

<style>
  /* Mermaid diagram container - light background */
  .language-mermaid,
  pre.mermaid,
  .mermaid {
    background-color: #ffffff !important;
    border-radius: 8px;
    padding: 16px;
    margin: 16px 0;
  }

  /* Ensure lines and arrows are dark and visible */
  .mermaid .edgePath .path,
  .mermaid .flowchart-link {
    stroke: #333333 !important;
    stroke-width: 2px !important;
  }

  .mermaid .arrowheadPath {
    fill: #333333 !important;
  }

  /* Sequence diagram lines */
  .mermaid .messageLine0,
  .mermaid .messageLine1 {
    stroke: #333333 !important;
    stroke-width: 1.5px !important;
  }

  /* Actor lines */
  .mermaid .actor-line {
    stroke: #666666 !important;
  }

  /* Mindmap lines */
  .mermaid .mindmap-edges path {
    stroke: #333333 !important;
    stroke-width: 2px !important;
  }

  /* Text visibility */
  .mermaid text,
  .mermaid .nodeLabel,
  .mermaid .label {
    fill: #1a1a1a !important;
    color: #1a1a1a !important;
  }

  /* Cluster labels */
  .mermaid .cluster-label text {
    fill: #1a1a1a !important;
  }
</style>
